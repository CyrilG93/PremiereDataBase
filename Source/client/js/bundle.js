/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={3(e){"use strict";e.exports=require("path")},200(e){"use strict";e.exports=require("child_process")},383(e){"use strict";e.exports=require("fs")},764(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function s(n,r,o,i){var s=r&&r.prototype instanceof l?r:l,d=Object.create(s.prototype);return a(d,"_invoke",function(n,r,o){var a,i,s,l=0,d=o||[],u=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,i=0,s=e,f.n=n,c}};function m(n,r){for(i=n,s=r,t=0;!u&&l&&!o&&t<d.length;t++){var o,a=d[t],m=f.p,p=a[2];n>3?(o=p===r)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(i=0,f.v=r,f.n=a[1]):m<p&&(o=n<3||a[0]>r||r>p)&&(a[4]=n,a[5]=r,f.n=p,i=0))}if(o||n>1)return c;throw u=!0,r}return function(o,d,p){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&m(d,p),i=d,s=p;(t=i<2?e:s)||!u;){a||(i?i<3?(i>1&&(f.n=-1),m(i,s)):f.n=s:f.v=s);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(u=f.n<0)?s:n.call(r,f))!==c)break}catch(t){a=e,i=1,s=t}finally{l=1}}return{value:t,done:u}}}(n,o,i),!0),d}var c={};function l(){}function d(){}function u(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(a(t={},r,function(){return this}),t),m=u.prototype=l.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,a(e,i,"GeneratorFunction")),e.prototype=Object.create(m),e}return d.prototype=u,a(m,"constructor",u),a(u,"constructor",d),d.displayName="GeneratorFunction",a(u,i,"GeneratorFunction"),a(m),a(m,i,"Generator"),a(m,r,function(){return this}),a(m,"toString",function(){return"[object Generator]"}),(o=function(){return{w:s,m:p}})()}function a(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}a=function(e,t,n,r){function i(t,n){a(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},a(e,t,n,r)}function i(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t,n){return(t=function(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}var m=n(383),p=n(3),v="win32"===process.platform,g="darwin"===process.platform,h={video:[".mp4",".mov",".avi",".mkv",".wmv",".flv",".webm",".m4v",".mpeg",".mpg",".3gp",".mxf",".r3d",".braw",".prores"],audio:[".mp3",".wav",".aiff",".aif",".m4a",".aac",".ogg",".flac",".wma",".opus"],image:[".jpg",".jpeg",".png",".gif",".tiff",".tif",".psd",".ai",".eps",".bmp",".webp",".svg",".raw",".cr2",".nef",".arw"]};function y(e){return e?p.normalize(e):""}function b(e){return e?e.replace(/\\/g,"/"):""}function E(e){return p.extname(e).toLowerCase()}function w(e){var t=E(e);return h.video.includes(t)?"video":h.audio.includes(t)?"audio":h.image.includes(t)?"image":"other"}function I(e){try{return m.existsSync(e)}catch(e){return!1}}function x(e){try{return m.existsSync(e)||m.mkdirSync(e,{recursive:!0}),{success:!0}}catch(e){return console.error("Error creating directory:",e),{success:!1,error:e.message}}}function P(e,t){return new Promise(function(n,r){try{var o=y(e),a=y(t);if(!I(o))return void r(new Error("Source file does not exist: "+o));if(I(a))return void n({skipped:!0,reason:"File already exists"});if(!x(p.dirname(a)).success)return void r(new Error("Failed to create destination directory"));m.copyFileSync(o,a),n({success:!0})}catch(e){r(e)}})}function S(){var e;return e=o().m(function e(t,n){var r,a,i,s,c,l;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:r=[],a=t.length,i=0;case 1:if(!(i<t.length)){e.n=7;break}return s=t[i],e.p=2,e.n=3,P(s.source,s.destination);case 3:c=e.v,r.push({name:s.name,success:!0,skipped:c.skipped||!1,reason:c.reason||null}),e.n=5;break;case 4:e.p=4,l=e.v,r.push({name:s.name,success:!1,error:l.message});case 5:n&&n({current:i+1,total:a,percent:Math.round((i+1)/a*100)});case 6:i++,e.n=1;break;case 7:return e.a(2,r)}},e,null,[[2,4]])}),S=function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){f(a,r,o,i,s,"next",e)}function s(e){f(a,r,o,i,s,"throw",e)}i(void 0)})},S.apply(this,arguments)}function B(e){if(0===e)return"0 B";var t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["B","KB","MB","GB"][t]}e.exports&&(e.exports={IS_WINDOWS:v,IS_MAC:g,FILE_TYPES:h,normalizePathForPlatform:y,toForwardSlashes:b,getExtension:E,getFileType:w,fileExists:I,isDirectory:function(e){try{return m.statSync(e).isDirectory()}catch(e){return!1}},createDirectory:x,deletePath:function(e){try{return m.statSync(e).isDirectory()?m.rmSync(e,{recursive:!0,force:!0}):m.unlinkSync(e),{success:!0}}catch(e){return console.error("Error deleting path:",e),{success:!1,error:e.message}}},movePath:function(e,t){try{var n=p.dirname(t);return m.existsSync(n)||m.mkdirSync(n,{recursive:!0}),m.renameSync(e,t),{success:!0}}catch(e){return console.error("Error moving path:",e),{success:!1,error:e.message}}},copyFile:P,copyFiles:function(e,t){return S.apply(this,arguments)},scanDatabase:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.bannedExtensions,o=void 0===r?[]:r,a=n.excludedFolderNames,s=void 0===a?[".git","node_modules","__MACOSX",".DS_Store"]:a,l=n.currentPath,u=void 0===l?"":l,f={files:[],folders:[]};try{var v=u?p.join(t,u):t;if(!m.existsSync(v))return f;var g,h=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=d(e))){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw o}}}}(m.readdirSync(v));try{for(h.s();!(g=h.n()).done;){var y=g.value;if(!y.startsWith(".")&&!s.includes(y)){var I=p.join(v,y),x=u?p.join(u,y):y;try{var P=m.statSync(I);if(P.isDirectory()){var S,B;f.folders.push({name:y,path:b(I),relativePath:b(x)});var k=e(t,c(c({},n),{},{currentPath:x}));(S=f.files).push.apply(S,i(k.files)),(B=f.folders).push.apply(B,i(k.folders))}else if(P.isFile()){var L=E(y);if(o.includes(L))continue;var _=w(y);"other"!==_&&f.files.push({name:y,path:b(I),relativePath:b(x),folderPath:b(u),type:_,size:P.size,modified:P.mtime.getTime()})}}catch(e){console.warn("Error accessing item:",I,e.message)}}}}catch(e){h.e(e)}finally{h.f()}}catch(e){console.error("Error scanning database:",e)}return f},formatFileSize:B,getFileInfo:function(e){try{var t=m.statSync(e);return{exists:!0,size:t.size,formattedSize:B(t.size),modified:t.mtime,isDirectory:t.isDirectory()}}catch(e){return{exists:!1}}},openInExplorer:function(e){var t=n(200).exec,r=p.normalize(e);g?t('open "'.concat(r,'"')):v&&t('explorer "'.concat(r,'"'))}})},863(e,t,n){"use strict";n.d(t,{A:()=>a});const r=require("events");e=n.hmd(e);class o extends r.EventEmitter{constructor(e,t,n){if(super(),this.pluginName=e,this.pluginID=t,this._commands=n||[],this._commandListener=null,!this.pluginName||!this.pluginID)throw new Error("pluginName && pluginID required");this._addEventListener("knights_of_the_editing_table.spellbook.app.opened",()=>this.register(this._commands)),this.start()}register(e){if(!this.pluginName||!e)throw new Error("pluginName && commands required");{this._commands=e;const t={pluginID:this.pluginID,name:this.pluginName,commands:e};this._dispatchEvent("knights_of_the_editing_table.spellbook.api.commands.add",t)}}start(){const e=`knights_of_the_editing_table.spellbook.api.${this.pluginID}.command.registered`;this._commandListener=e=>{const t=e.data,n=this._find(t);n&&("function"==typeof n.action&&n.action(),this.emit(t,t))},this._addEventListener(e,this._commandListener)}stop(){const e=`knights_of_the_editing_table.spellbook.api.${this.pluginID}.command.registered`;this._commandListener&&(this._removeEventListener(e,this._commandListener),this._commandListener=null)}_find(e){return this._commands&&this._commands.find(t=>t.commandID===e)}_addEventListener(e,t){"undefined"!=typeof window&&window.__adobe_cep__&&window.__adobe_cep__.addEventListener(e,t)}_removeEventListener(e,t){"undefined"!=typeof window&&window.__adobe_cep__&&window.__adobe_cep__.removeEventListener(e,t)}_dispatchEvent(e,t){"undefined"!=typeof window&&window.__adobe_cep__&&window.__adobe_cep__.dispatchEvent({type:e,scope:"APPLICATION",appId:JSON.parse(window.__adobe_cep__.getHostEnvironment()).appId,extensionId:window.__adobe_cep__.getExtensionId(),data:JSON.stringify(t)})}}const a=o;e.exports=o}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r](a,a.exports,n),a.loaded=!0,a.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=n(863).A;function t(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function a(e,t,n){return(t=function(e){var t=function(e){if("object"!=d(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var i=r&&r.prototype instanceof l?r:l,d=Object.create(i.prototype);return s(d,"_invoke",function(n,r,o){var a,i,s,l=0,d=o||[],u=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,i=0,s=e,f.n=n,c}};function m(n,r){for(i=n,s=r,t=0;!u&&l&&!o&&t<d.length;t++){var o,a=d[t],m=f.p,p=a[2];n>3?(o=p===r)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(i=0,f.v=r,f.n=a[1]):m<p&&(o=n<3||a[0]>r||r>p)&&(a[4]=n,a[5]=r,f.n=p,i=0))}if(o||n>1)return c;throw u=!0,r}return function(o,d,p){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&m(d,p),i=d,s=p;(t=i<2?e:s)||!u;){a||(i?i<3?(i>1&&(f.n=-1),m(i,s)):f.n=s:f.v=s);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(u=f.n<0)?s:n.call(r,f))!==c)break}catch(t){a=e,i=1,s=t}finally{l=1}}return{value:t,done:u}}}(n,o,a),!0),d}var c={};function l(){}function d(){}function u(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(s(t={},r,function(){return this}),t),m=u.prototype=l.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,s(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e}return d.prototype=u,s(m,"constructor",u),s(u,"constructor",d),d.displayName="GeneratorFunction",s(u,o,"GeneratorFunction"),s(m),s(m,o,"Generator"),s(m,r,function(){return this}),s(m,"toString",function(){return"[object Generator]"}),(i=function(){return{w:a,m:p}})()}function s(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}s=function(e,t,n,r){function a(t,n){s(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},s(e,t,n,r)}function c(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){c(a,r,o,i,s,"next",e)}function s(e){c(a,r,o,i,s,"throw",e)}i(void 0)})}}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=f(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function f(e,t){if(e){if("string"==typeof e)return m(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var p=new CSInterface;p.addEventListener("com.database.premiere.open",function(e){p.requestOpenExtension("com.database.premiere.panel","")});var v=n(764),g=v.scanDatabase,h=v.copyFiles;function y(){try{var t=[{commandID:"com.database.premiere.showPanel",name:"Show Database Panel",group:"Data Base",action:function(){p.requestOpenExtension("com.database.premiere.panel","")}},{commandID:"com.database.premiere.refresh",name:"Refresh Database",group:"Data Base",action:function(){Q(),V(T("status.scanning"),"info")}},{commandID:"com.database.premiere.addToDb",name:"Add Selection to Database",group:"Data Base",action:function(){z()}}];new e("Data Base","com.database.premiere.panel",t).register(t),console.log("[Spell Book] Integration initialized internally with",t.length,"commands")}catch(e){console.log("[Spell Book] Initialization error:",e.message)}}var b={en:{labels:{database:"Database:",notConfigured:"Not configured",files:"files",selected:"selected"},search:{placeholder:"Search files..."},filters:{all:"All",video:"Video",audio:"Audio",image:"Image"},buttons:{import:"Import",save:"Save",cancel:"Cancel",create:"Create",addToDb:"Add to DB"},settings:{title:"Settings",databasePath:"Database Path",databasePathPlaceholder:"Select database folder...",language:"Language",consolidateOnImport:"Copy files to project folder on import",consolidateDescription:"When enabled, files will be copied to the project folder before importing, preserving the folder structure.",bannedExtensions:"Excluded file extensions",bannedExtensionsPlaceholder:"e.g.: .txt, .pdf, .zip (one per line)",excludedFolders:"Excluded folder names",excludedFoldersPlaceholder:"e.g.: node_modules, .git (one per line)",consolidationDepth:"Consolidation folder depth",consolidationDepthHint:"0 = project file folder, 1 = one folder up, etc.",flattenImportPath:"Import to root folder only",flattenImportPathDescription:"When enabled, files are imported into the first-level folder only (e.g., ELEMENTS/IMAGES/file.png ‚Üí ELEMENTS bin)."},empty:{configureDatabase:"Configure your database path in settings",noFilesFound:"No files found",noFavorites:"No favorites yet"},modal:{newFolder:"New Folder",folderNamePlaceholder:"Folder name",deleteConfirm:"Are you sure you want to delete this?"},context:{addFavorite:"Add to favorites",removeFavorite:"Remove from favorites",openFolder:"Open in Finder",importFolder:"Import Folder",delete:"Delete"},status:{loading:"Loading...",scanning:"Scanning database...",importing:"Importing files...",importSuccess:"files imported successfully",importError:"Import failed",saved:"Settings saved",folderCreated:"Folder created",folderDeleted:"Folder deleted",copied:"Copied to clipboard"}},fr:{labels:{database:"Base de donn√©es :",notConfigured:"Non configur√©",files:"fichiers",selected:"s√©lectionn√©(s)"},search:{placeholder:"Rechercher des fichiers..."},filters:{all:"Tous",video:"Vid√©o",audio:"Audio",image:"Image"},buttons:{import:"Importer",save:"Enregistrer",cancel:"Annuler",create:"Cr√©er",addToDb:"Ajouter √† la base"},settings:{title:"Param√®tres",databasePath:"Chemin de la base de donn√©es",databasePathPlaceholder:"S√©lectionner le dossier...",language:"Langue",consolidateOnImport:"Copier les fichiers dans le dossier projet lors de l'import",consolidateDescription:"Lorsque cette option est activ√©e, les fichiers seront copi√©s dans le dossier du projet avant l'import, en pr√©servant la structure des dossiers.",bannedExtensions:"Extensions de fichiers exclues",bannedExtensionsPlaceholder:"ex: .txt, .pdf, .zip (une par ligne)",excludedFolders:"Noms de dossiers exclus",excludedFoldersPlaceholder:"ex: node_modules, .git (un par ligne)",consolidationDepth:"Profondeur du dossier de consolidation",consolidationDepthHint:"0 = dossier du projet, 1 = un dossier au-dessus, etc.",flattenImportPath:"Importer dans le dossier racine uniquement",flattenImportPathDescription:"Lorsque cette option est activ√©e, les fichiers sont import√©s uniquement dans le dossier de premier niveau (ex: ELEMENTS/IMAGES/fichier.png ‚Üí bin ELEMENTS)."},empty:{configureDatabase:"Configurez le chemin de la base de donn√©es dans les param√®tres",noFilesFound:"Aucun fichier trouv√©",noFavorites:"Aucun favori"},modal:{newFolder:"Nouveau dossier",folderNamePlaceholder:"Nom du dossier",deleteConfirm:"√ätes-vous s√ªr de vouloir supprimer ceci ?"},context:{addFavorite:"Ajouter aux favoris",removeFavorite:"Retirer des favoris",openFolder:"Ouvrir dans le Finder",importFolder:"Importer le dossier",delete:"Supprimer"},status:{loading:"Chargement...",scanning:"Analyse de la base de donn√©es...",importing:"Import des fichiers...",importSuccess:"fichiers import√©s avec succ√®s",importError:"√âchec de l'import",saved:"Param√®tres enregistr√©s",folderCreated:"Dossier cr√©√©",folderDeleted:"Dossier supprim√©",copied:"Copi√© dans le presse-papiers"}}},E="en",w={databasePath:"",language:"en",itemSize:0,consolidateOnImport:!1,consolidationDepth:0,flattenImportPath:!1,bannedExtensions:[".txt",".pdf",".zip",".rar",".exe",".doc",".docx",".prproj"],excludedFolderNames:[".git","node_modules","__MACOSX","Adobe Premiere Pro Auto-Save"]},I=[],x=[],P=[],S=new Set,B=new Set,k="",L="list",_=["all"],O=!1,F="",j=null,D=null,A=null,C=new Set;function T(e){var t,n=e.split("."),r=b[E],o=u(n);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(!r||"object"!==d(r)||!(a in r)){r=b.en;var i,s=u(n);try{for(s.s();!(i=s.n()).done;){var c=i.value;if(!r||"object"!==d(r)||!(c in r))return e;r=r[c]}}catch(e){s.e(e)}finally{s.f()}break}r=r[a]}}catch(e){o.e(e)}finally{o.f()}return r}function N(){document.querySelectorAll("[data-i18n]").forEach(function(e){var t=T(e.getAttribute("data-i18n"));"INPUT"===e.tagName&&"button"===e.type?e.value=t:e.textContent=t}),document.querySelectorAll("[data-i18n-placeholder]").forEach(function(e){var t=e.getAttribute("data-i18n-placeholder");e.placeholder=T(t)})}function M(e){b[e]&&(E=e,w.language=e,N(),G())}function z(){w.databasePath?(R(T("status.scanning")),p.evalScript("getSelectedProjectItems()",function(){var e=l(i().m(function e(t){var n,r,o,a;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:console.log("Selected items result:",t),e.p=1,n=JSON.parse(t),e.n=3;break;case 2:return e.p=2,o=e.v,W(),V("Premiere Error: "+t,"error"),console.error("Parse error:",o,t),e.a(2);case 3:if(!n||!n.error){e.n=4;break}return W(),V("Premiere Error: "+n.error,"error"),e.a(2);case 4:if(e.p=4,n&&Array.isArray(n)&&0!==n.length){e.n=5;break}return W(),V(T("empty.noFilesFound"),"info"),e.a(2);case 5:return R(T("status.importing")),r=n.map(function(e){return{name:e.name,source:e.path,destination:w.databasePath+"/"+(e.binPath?e.binPath+"/":"")+e.name}}),e.n=6,h(r,function(e){U(e.percent,"Copying ".concat(e.current,"/").concat(e.total,"..."))});case 6:W(),V("".concat(n.length," files added to database"),"success"),Q(),e.n=8;break;case 7:e.p=7,a=e.v,W(),V("Error adding to database: "+a.message,"error"),console.error(a);case 8:return e.a(2)}},e,null,[[4,7],[1,2]])}));return function(t){return e.apply(this,arguments)}}())):V(T("empty.configureDatabase"),"error")}function q(e){var t=100+(e=parseInt(e)||0)/100*200,n=32+e/100*32;document.documentElement.style.setProperty("--grid-item-size",Math.round(t)+"px"),document.documentElement.style.setProperty("--list-icon-size",Math.round(n)+"px")}function G(){w.databasePath=document.getElementById("databasePathInput").value.trim(),w.consolidateOnImport=document.getElementById("consolidateOnImport").checked,w.consolidationDepth=parseInt(document.getElementById("consolidationDepth").value)||0,w.flattenImportPath=document.getElementById("flattenImportPath").checked;var e=document.getElementById("bannedExtensions").value;w.bannedExtensions=e.split("\n").map(function(e){return e.trim()}).filter(function(e){return""!==e}).map(function(e){return e.startsWith(".")?e:"."+e});var t=document.getElementById("excludedFolders").value;w.excludedFolderNames=t.split("\n").map(function(e){return e.trim()}).filter(function(e){return""!==e}),w.language=E,localStorage.setItem("databaseSettings",JSON.stringify(w)),J(),V(T("status.saved"),"success")}function H(){localStorage.setItem("databaseFavorites",JSON.stringify(t(B)))}function J(){var e=document.getElementById("databasePath");if(w.databasePath){var t=w.databasePath.split(/[\/\\]/);e.textContent=".../"+t.slice(-2).join("/"),e.title=w.databasePath}else e.textContent=T("labels.notConfigured"),e.title=""}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=document.getElementById("statusMessage");n.textContent=e,n.className="status-message visible "+t,setTimeout(function(){n.classList.remove("visible")},4e3)}function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";document.getElementById("progressSection").classList.add("visible"),e&&(document.getElementById("progressText").textContent=e)}function W(){document.getElementById("progressSection").classList.remove("visible")}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";document.getElementById("progressBar").style.width=e+"%",t&&(document.getElementById("progressText").textContent=t)}function $(){document.getElementById("settingsPanel").classList.add("visible"),document.getElementById("settingsOverlay").classList.add("visible")}function X(){document.getElementById("settingsPanel").classList.remove("visible"),document.getElementById("settingsOverlay").classList.remove("visible")}function Y(){document.getElementById("newFolderModal").classList.add("visible"),document.getElementById("newFolderName").value="",document.getElementById("newFolderName").focus()}function K(){document.getElementById("newFolderModal").classList.remove("visible")}function Q(){if(!w.databasePath)return V(T("empty.configureDatabase"),"warning"),void $();R(T("status.scanning")),U(0);try{var e=(t=w.databasePath,n={bannedExtensions:w.bannedExtensions,excludedFolderNames:w.excludedFolderNames},"function"==typeof g?g(t,n):(console.error("scanDatabase function not found in imported fileOperations"),{files:[],folders:[]}));I=e.files||[],x=e.folders||[],W(),Z(),ue(),console.log("Scanned: ".concat(I.length," files, ").concat(x.length," folders"))}catch(e){W(),console.error("Scan error:",e),V("Error scanning database: "+e.message,"error")}var t,n}function Z(){var e=t(I);if(k&&(e=e.filter(function(e){return e.folderPath===k||e.folderPath.startsWith(k+"/")})),F){var n=F.toLowerCase();e=e.filter(function(e){return e.name.toLowerCase().includes(n)||e.folderPath.toLowerCase().includes(n)})}_.includes("all")||(e=e.filter(function(e){return _.includes(e.type)})),O&&(e=e.filter(function(e){return B.has(e.path)})),P=e,document.getElementById("fileCount").textContent=P.length,ne()}function ee(){O=!O,document.getElementById("favoritesBtn").classList.toggle("active",O),Z()}function te(){document.getElementById("searchInput").value="",F="",Z()}function ne(){var e,t=document.getElementById("fileBrowser"),n=x.filter(function(e){return k?e.relativePath.substring(0,e.relativePath.lastIndexOf("/"))===k:!e.relativePath.includes("/")});if(0===(e=F?P:P.filter(function(e){if(e.folderPath===k)return!0;var t,n=u(C);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e.folderPath===r)return!0}}catch(e){n.e(e)}finally{n.f()}return!1})).length&&0===n.length){var r=T("empty.noFilesFound");return w.databasePath?O?r=T("empty.noFavorites"):F&&(r=T("empty.noFilesFound")):r=T("empty.configureDatabase"),void(t.innerHTML='\n            <div class="empty-state">\n                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"\n                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />\n                </svg>\n                <p>'.concat(r,"</p>\n            </div>\n        "))}var o='<div class="file-list">';if(F){var a,i=u(e);try{for(i.s();!(a=i.n()).done;)o+=ae(a.value,!0)}catch(e){i.e(e)}finally{i.f()}}else{var s,c=u(n);try{for(c.s();!(s=c.n()).done;){var l=s.value;o+=oe(l),"list"===L&&C.has(l.relativePath)&&(o+=re(l.relativePath))}}catch(e){c.e(e)}finally{c.f()}var d,f=u(e.filter(function(e){return e.folderPath===k}));try{for(f.s();!(d=f.n()).done;)o+=ae(d.value,!1)}catch(e){f.e(e)}finally{f.f()}}o+="</div>",t.innerHTML=o,document.querySelectorAll(".folder-expand").forEach(function(e){e.addEventListener("click",function(t){t.stopPropagation(),de(e.getAttribute("data-folder"))})}),document.querySelectorAll(".file-item.folder").forEach(function(e){e.addEventListener("click",function(t){if(!t.target.closest(".folder-expand")){var n=e.getAttribute("data-path");"grid"===L?le(n):de(n)}}),e.addEventListener("dblclick",function(){le(e.getAttribute("data-path"))})}),document.querySelectorAll('.file-item[data-type="file"]').forEach(function(e){e.addEventListener("click",function(t){var n;t.target.closest(".file-checkbox")||t.target.closest(".file-favorite")||(n=e.getAttribute("data-path"),S.has(n)?S.delete(n):S.add(n),ie(),ne())})}),document.querySelectorAll(".file-checkbox").forEach(function(e){e.addEventListener("change",function(t){t.stopPropagation();var n=e.closest(".file-item").getAttribute("data-path");e.checked?S.add(n):S.delete(n),ie()})}),document.querySelectorAll(".file-favorite").forEach(function(e){e.addEventListener("click",function(t){var n;t.stopPropagation(),n=e.getAttribute("data-path"),B.has(n)?B.delete(n):B.add(n),H(),ne()})}),document.querySelectorAll(".audio-play-btn").forEach(function(e){e.addEventListener("click",function(t){t.stopPropagation(),function(e,t){var n=document.getElementById("audioPlayer");if(A===e&&!n.paused)return n.pause(),n.currentTime=0,A=null,t.classList.remove("playing"),void(t.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <polygon points="5 3 19 12 5 21" fill="currentColor" />\n        </svg>');if(A){n.pause();var r=document.querySelector('.audio-play-btn[data-audio-path="'.concat(CSS.escape(A),'"]'));r&&(r.classList.remove("playing"),r.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <polygon points="5 3 19 12 5 21" fill="currentColor" />\n            </svg>')}n.src=e,n.play().then(function(){A=e,t.classList.add("playing"),t.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <rect x="6" y="4" width="4" height="16" fill="currentColor" />\n            <rect x="14" y="4" width="4" height="16" fill="currentColor" />\n        </svg>'}).catch(function(e){console.error("Audio playback error:",e),V("Cannot play this audio format","error")}),n.onended=function(){A=null,t.classList.remove("playing"),t.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <polygon points="5 3 19 12 5 21" fill="currentColor" />\n        </svg>'}}(e.getAttribute("data-audio-path"),e)})}),document.querySelectorAll(".file-item").forEach(function(e){e.addEventListener("contextmenu",function(t){t.preventDefault(),function(e,t,n){var r=document.getElementById("contextMenu"),o=document.getElementById("contextAddFavorite"),a=document.getElementById("contextRemoveFavorite"),i=document.getElementById("contextImportFolder");if("folder"===n)o.classList.add("hidden"),a.classList.add("hidden"),i.classList.remove("hidden");else{var s=B.has(t);o.classList.toggle("hidden",s),a.classList.toggle("hidden",!s),i.classList.add("hidden")}r.style.left=e.clientX+"px",r.style.top=e.clientY+"px",r.classList.add("visible"),contextMenuFile=t,r.dataset.filePath=t,r.dataset.type=n}(t,e.getAttribute("data-path"),e.getAttribute("data-type"))})})}function re(e){var t,n="",r=20*(e.split("/").length-(k?k.split("/").length:0)),o=u(x.filter(function(t){return t.relativePath.substring(0,t.relativePath.lastIndexOf("/"))===e}));try{for(o.s();!(t=o.n()).done;){var a=t.value;n+=oe(a,r),C.has(a.relativePath)&&(n+=re(a.relativePath))}}catch(e){o.e(e)}finally{o.f()}var i,s=u(P.filter(function(t){return t.folderPath===e}));try{for(s.s();!(i=s.n()).done;)n+=ae(i.value,!1,r)}catch(e){s.e(e)}finally{s.f()}return n}function oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=C.has(e.relativePath)?"‚ñº":"‚ñ∂",r="list"===L?'<span class="folder-expand" data-folder="'.concat(we(e.relativePath),'">').concat(n,"</span>"):"",o=t>0?'style="margin-left: '.concat(t,'px"'):"";return'\n        <div class="file-item folder" data-path="'.concat(we(e.relativePath),'" data-type="folder" ').concat(o,">\n            ").concat(r,'\n            <div class="file-icon">\n                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"\n                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="rgba(0,120,212,0.2)" />\n                </svg>\n            </div>\n            <div class="file-info">\n                <div class="file-name">').concat(we(e.name),"</div>\n            </div>\n        </div>\n    ")}function ae(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=B.has(e.path),o=S.has(e.path),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){if("image"===e){var n=t.replace(/'/g,"\\'");return'<div class="thumbnail-image" style="background-image: url(\''.concat(n,"')\"></div>")}if("video"===e){var r=t.split(".").pop().toLowerCase();if(["mp4","webm","mov","m4v"].includes(r))return'<video class="thumbnail-video" src="'.concat(t,'" preload="metadata" muted onmouseover="this.play()" onmouseout="this.pause();this.currentTime=0;"></video>')}}switch(e){case"video":return'<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <rect x="2" y="4" width="20" height="16" rx="2" stroke="currentColor" stroke-width="2" />\n                <polygon points="10 9 16 12 10 15" fill="currentColor" />\n            </svg>';case"audio":return'<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M9 18V5l12-2v13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />\n                <circle cx="6" cy="18" r="3" stroke="currentColor" stroke-width="2" />\n                <circle cx="18" cy="16" r="3" stroke="currentColor" stroke-width="2" />\n            </svg>';case"image":return'<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2" />\n                <circle cx="8.5" cy="8.5" r="1.5" fill="currentColor" />\n                <path d="M21 15l-5-5L5 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />\n            </svg>';default:return'<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2" />\n                <polyline points="14 2 14 8 20 8" stroke="currentColor" stroke-width="2" />\n            </svg>'}}(e.type,e.path),i=e.folderPath||"Root";t&&(i=e.folderPath||"Root");var s=n>0?'style="margin-left: '.concat(n,'px"'):"",c="audio"===e.type?'\n        <button class="audio-play-btn" data-audio-path="'.concat(we(e.path),'" title="Play/Pause">\n            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <polygon points="5 3 19 12 5 21" fill="currentColor" />\n            </svg>\n        </button>\n    '):"";return'\n        <div class="file-item '.concat(o?"selected":"",'" data-path="').concat(we(e.path),'" data-type="file" ').concat(s,'>\n            <input type="checkbox" class="file-checkbox" ').concat(o?"checked":"",'>\n            <div class="file-icon ').concat(e.type,'">\n                ').concat(a,'\n            </div>\n            <div class="file-info">\n                <div class="file-name">').concat(we(e.name),'</div>\n                <div class="file-path">üìÅ ').concat(we(i),"</div>\n            </div>\n            ").concat(c,'\n            <button class="file-favorite ').concat(r?"active":"",'" data-path="').concat(we(e.path),'">\n                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"\n                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />\n                </svg>\n            </button>\n        </div>\n    ')}function ie(){document.getElementById("selectedCount").textContent=S.size,document.getElementById("importBtn").disabled=0===S.size}function se(){P.forEach(function(e){return S.add(e.path)}),ie(),ne()}function ce(){S.clear(),ie(),ne()}function le(e){k=e,S.clear(),C.clear(),ie(),Z(),ue()}function de(e){C.has(e)?C.delete(e):C.add(e),ne()}function ue(){var e=document.getElementById("homeBtn");e&&(e.onclick=function(){return le("")});var t=document.getElementById("backBtn");t&&(t.onclick=function(){return function(){if(k){var e=k.lastIndexOf("/");k=e>0?k.substring(0,e):"",S.clear(),ie(),Z(),ue()}}()},t.disabled=!k,t.classList.toggle("disabled",!k))}function fe(e){L=e;var t=document.getElementById("fileBrowser");"grid"===e?t.classList.add("grid-view"):t.classList.remove("grid-view"),document.getElementById("listViewBtn").classList.toggle("active","list"===e),document.getElementById("gridViewBtn").classList.toggle("active","grid"===e),ne()}function me(){var e=document.getElementById("newFolderName").value.trim();if(e){var t=k?w.databasePath+"/"+k:w.databasePath,n=createDirectory(t+"/"+e);n.success?(K(),V(T("status.folderCreated"),"success"),Q()):V(n.error,"error")}}function pe(){return ve.apply(this,arguments)}function ve(){return(ve=l(i().m(function e(){var t;return i().w(function(e){for(;;)switch(e.n){case 0:if(0!==S.size){e.n=1;break}return e.a(2);case 1:return t=I.filter(function(e){return S.has(e.path)}),e.n=2,he(t);case 2:e.v>0&&(S.clear(),ie(),ne());case 3:return e.a(2)}},e)}))).apply(this,arguments)}function ge(){return(ge=l(i().m(function e(t){var n;return i().w(function(e){for(;;)switch(e.n){case 0:if(0!==(n=I.filter(function(e){return e.folderPath===t||e.folderPath&&e.folderPath.startsWith(t+"/")})).length){e.n=1;break}return V(T("empty.noFilesFound"),"warning"),e.a(2);case 1:return e.n=2,he(n);case 2:return e.a(2)}},e)}))).apply(this,arguments)}function he(e){return ye.apply(this,arguments)}function ye(){return(ye=l(i().m(function e(t){var n,r,o,a,s,c,l,d,u,f;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(R(T("status.importing")),U(0),e.p=1,n=t.map(function(e){var t=e.folderPath||"";if(w.flattenImportPath&&t){var n=t.split("/");t=n[0]||""}return{name:e.name,path:e.path,binPath:t}}),!w.consolidateOnImport){e.n=11;break}return r=null,e.p=2,e.n=3,be();case 3:r=e.v,e.n=5;break;case 4:e.p=4,u=e.v,console.error("Error getting project path",u);case 5:if(!r){e.n=11;break}o=r.substring(0,r.lastIndexOf("/")),a=0;case 6:if(!(a<(w.consolidationDepth||0))){e.n=9;break}if(!((s=o.lastIndexOf("/"))>0)){e.n=7;break}o=o.substring(0,s),e.n=8;break;case 7:return e.a(3,9);case 8:a++,e.n=6;break;case 9:return c=n.map(function(e){return{name:e.name,source:e.path,destination:o+"/"+(e.binPath?e.binPath+"/":"")+e.name}}),e.n=10,h(c,function(e){U(.5*e.percent,"Copying ".concat(e.current,"/").concat(e.total,"..."))});case 10:n.forEach(function(e,t){e.path=c[t].destination});case 11:return U(50,T("status.importing")),l=JSON.stringify(n),d=btoa(unescape(encodeURIComponent(l))),e.a(2,new Promise(function(e){p.evalScript("DataBase_importFilesToProjectBase64('".concat(d,"')"),function(t){W();try{var n=JSON.parse(t);if(n.error)V(T("status.importError")+": "+n.error,"error"),e(0);else{var r=n.totalImported||0;V("".concat(r," ").concat(T("status.importSuccess")),"success"),e(r)}}catch(t){V(T("status.importError"),"error"),console.error("Import error:",t),e(0)}})}));case 12:return e.p=12,f=e.v,W(),V(T("status.importError"),"error"),console.error("Import failed:",f),e.a(2,0)}},e,null,[[2,4],[1,12]])}))).apply(this,arguments)}function be(){return new Promise(function(e){p.evalScript("DataBase_getProjectPath()",function(t){e("null"===t?null:t)})})}function Ee(){document.getElementById("contextMenu").classList.remove("visible")}function we(e){if(!e)return"";var t=document.createElement("div");return t.textContent=e,t.innerHTML}function Ie(){p.evalScript("DataBase_selectFolder()",function(e){e&&"null"!==e&&(document.getElementById("databasePathInput").value=e)})}document.addEventListener("DOMContentLoaded",function(){!function(){var e=localStorage.getItem("databaseSettings");if(e)try{var t=JSON.parse(e);w=o(o({},w),t),E=w.language||"en"}catch(e){console.error("Error loading settings:",e)}var n=localStorage.getItem("databaseFavorites");if(n)try{B=new Set(JSON.parse(n))}catch(e){console.error("Error loading favorites:",e)}document.getElementById("databasePathInput").value=w.databasePath||"",document.getElementById("consolidateOnImport").checked=w.consolidateOnImport||!1,document.getElementById("consolidationDepth").value=w.consolidationDepth||0,document.getElementById("flattenImportPath").checked=w.flattenImportPath||!1,document.getElementById("bannedExtensions").value=(w.bannedExtensions||[]).join("\n"),document.getElementById("excludedFolders").value=(w.excludedFolderNames||[]).join("\n"),document.getElementById("languageSelect").value=E,document.getElementById("settingsLanguageSelect").value=E,J(),N(),void 0!==w.itemSize&&(document.getElementById("sizeSlider").value=w.itemSize,q(w.itemSize))}(),setTimeout(y,1e3),document.getElementById("settingsBtn").addEventListener("click",$),document.getElementById("closeSettingsBtn").addEventListener("click",X),document.getElementById("settingsOverlay").addEventListener("click",X),document.getElementById("saveSettingsBtn").addEventListener("click",function(){G(),X(),Q()}),document.getElementById("browseDatabaseBtn").addEventListener("click",Ie),document.getElementById("languageSelect").addEventListener("change",function(e){M(e.target.value),document.getElementById("settingsLanguageSelect").value=e.target.value}),document.getElementById("settingsLanguageSelect").addEventListener("change",function(e){M(e.target.value),document.getElementById("languageSelect").value=e.target.value}),document.getElementById("searchInput").addEventListener("input",function(e){var t;t=e.target.value,F=t,j&&clearTimeout(j),j=setTimeout(function(){Z()},300)}),document.getElementById("clearSearch").addEventListener("click",te),document.getElementById("favoritesBtn").addEventListener("click",ee),document.querySelectorAll(".type-filter-btn").forEach(function(e){e.addEventListener("click",function(){var t;"all"===(t=e.getAttribute("data-type"))?_=["all"]:_.includes("all")?_=[t]:_.includes(t)?(_=_.filter(function(e){return e!==t}),0===_.length&&(_=["all"])):_.push(t),document.querySelectorAll(".type-filter-btn").forEach(function(e){var t=e.getAttribute("data-type");e.classList.toggle("active",_.includes(t))}),Z()})}),document.getElementById("listViewBtn").addEventListener("click",function(){return fe("list")}),document.getElementById("gridViewBtn").addEventListener("click",function(){return fe("grid")}),document.getElementById("sizeSlider").addEventListener("input",function(e){var t=e.target.value;w.itemSize=t,q(t),clearTimeout(D),D=setTimeout(function(){localStorage.setItem("databaseSettings",JSON.stringify(w))},500)}),document.getElementById("selectAllBtn").addEventListener("click",se),document.getElementById("deselectAllBtn").addEventListener("click",ce),document.getElementById("importBtn").addEventListener("click",pe),document.getElementById("addToDbBtn").addEventListener("click",z),document.getElementById("newFolderBtn").addEventListener("click",Y),document.getElementById("refreshBtn").addEventListener("click",Q),document.getElementById("closeNewFolderModal").addEventListener("click",K),document.getElementById("cancelNewFolder").addEventListener("click",K),document.getElementById("confirmNewFolder").addEventListener("click",me),document.getElementById("newFolderName").addEventListener("keypress",function(e){"Enter"===e.key&&me()}),document.getElementById("contextAddFavorite").addEventListener("click",function(){var e=document.getElementById("contextMenu").dataset.filePath;B.add(e),H(),ne(),Ee()}),document.getElementById("contextRemoveFavorite").addEventListener("click",function(){var e=document.getElementById("contextMenu").dataset.filePath;B.delete(e),H(),ne(),Ee()}),document.getElementById("contextOpenFolder").addEventListener("click",function(){var e=document.getElementById("contextMenu").dataset.filePath;"folder"!==document.getElementById("contextMenu").dataset.type?e=e.substring(0,e.lastIndexOf("/")):e.includes(w.databasePath)||(e=w.databasePath+"/"+e),openInExplorer(e),Ee()}),document.getElementById("contextImportFolder").addEventListener("click",function(){!function(e){ge.apply(this,arguments)}(document.getElementById("contextMenu").dataset.filePath),Ee()}),document.getElementById("contextDelete").addEventListener("click",function(){var e=document.getElementById("contextMenu").dataset.filePath;if("folder"===document.getElementById("contextMenu").dataset.type&&e&&!e.includes(w.databasePath)&&(e=w.databasePath+"/"+e),confirm(T("modal.deleteConfirm"))){var t=deletePath(e);t.success?(V(T("status.folderDeleted"),"success"),Q()):V(t.error,"error")}Ee()}),document.addEventListener("click",function(e){e.target.closest(".context-menu")||Ee()}),w.databasePath&&setTimeout(Q,100),console.log("Data Base extension initialized")})})()})();